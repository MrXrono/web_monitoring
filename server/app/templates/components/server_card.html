<div class="col">
  <a href="/servers/{{ server.id }}" class="text-decoration-none">
    <div class="card server-card h-100 border-start border-4
      {% if server.status == 'online' %}border-success
      {% elif server.status == 'warning' %}border-warning
      {% elif server.status == 'critical' %}border-danger
      {% else %}border-secondary{% endif %}
      shadow-sm">
      <div class="card-body p-3">
        <div class="d-flex justify-content-between align-items-start mb-2">
          <div class="d-flex align-items-center">
            <span class="status-dot me-2
              {% if server.status == 'online' %}status-online
              {% elif server.status == 'warning' %}status-warning
              {% elif server.status == 'critical' %}status-critical
              {% else %}status-offline{% endif %}"></span>
            <span class="badge
              {% if server.status == 'online' %}bg-success
              {% elif server.status == 'warning' %}bg-warning text-dark
              {% elif server.status == 'critical' %}bg-danger
              {% else %}bg-secondary{% endif %}">
              {% if server.status == 'online' %}{{ _('Online') }}
              {% elif server.status == 'warning' %}{{ _('Warning') }}
              {% elif server.status == 'critical' %}{{ _('Critical') }}
              {% else %}{{ _('Offline') }}{% endif %}
            </span>
          </div>
          <small class="text-muted">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-clock me-1" viewBox="0 0 16 16">
              <path d="M8 3.5a.5.5 0 0 0-1 0V8a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 7.71V3.5z"/>
              <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
            </svg>
            <span class="relative-time" data-timestamp="{{ server.last_seen | default('') }}">
              {{ server.last_seen_display | default('N/A') }}
            </span>
          </small>
        </div>

        <h6 class="card-title fw-bold mb-1 text-dark">{{ server.hostname | default('Unknown') }}</h6>
        <p class="text-muted small mb-2">{{ server.ip | default('0.0.0.0') }}</p>

        {% if server.os_name is defined and server.os_name %}
        <p class="small text-muted mb-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-pc-display me-1" viewBox="0 0 16 16">
            <path d="M8 1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V1Zm1 13.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0Zm2 0a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0ZM9.5 1a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5ZM9 3.5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1h-5a.5.5 0 0 0-.5.5ZM1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12H6v2h-.5a.5.5 0 0 0 0 1H7v-4H1.5a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5H7V2H1.5Z"/>
          </svg>
          {{ server.os_name }}{% if server.os_version is defined and server.os_version %} {{ server.os_version }}{% endif %}
        </p>
        {% endif %}

        <div class="d-flex flex-wrap gap-2 mb-2">
          <span class="badge bg-light text-dark border small-badge" title="{{ _('Controllers') }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-cpu me-1" viewBox="0 0 16 16">
              <path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14A2.5 2.5 0 0 1 11.5 14v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
            </svg>
            Ctrl: {{ server.controllers_count | default(0) }}
          </span>
          <span class="badge bg-light text-dark border small-badge" title="{{ _('Virtual Drives') }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-hdd me-1" viewBox="0 0 16 16">
              <path d="M4.5 11a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zM3 10.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>
              <path d="M16 11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V9.51c0-.418.105-.83.305-1.197l2.472-4.531A1.5 1.5 0 0 1 4.094 3h7.812a1.5 1.5 0 0 1 1.317.782l2.472 4.53c.2.368.305.78.305 1.198V11zM3.655 4.26 1.592 8.043C1.724 8.014 1.86 8 2 8h12c.14 0 .276.014.408.042L12.345 4.26a.5.5 0 0 0-.439-.26H4.094a.5.5 0 0 0-.44.26zM1 10v1a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1z"/>
            </svg>
            VD: <span class="{% if server.vd_ok is defined and server.vd_total is defined and server.vd_ok < server.vd_total %}text-danger fw-bold{% else %}text-success{% endif %}">{{ server.vd_ok | default(0) }}</span>/{{ server.vd_total | default(0) }}
          </span>
          <span class="badge bg-light text-dark border small-badge" title="{{ _('Physical Drives') }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-device-hdd me-1" viewBox="0 0 16 16">
              <path d="M12 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm0 11a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm-7.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM5 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0ZM8 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"/>
              <path d="M12 7a4 4 0 0 1-3.937 4c-.27.007-.547-.04-.812-.105a3.16 3.16 0 0 1-.593-.225A4.008 4.008 0 0 1 4 7a4 4 0 0 1 8 0ZM8 4a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/>
              <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4Z"/>
            </svg>
            PD: <span class="{% if server.pd_ok is defined and server.pd_total is defined and server.pd_ok < server.pd_total %}text-danger fw-bold{% else %}text-success{% endif %}">{{ server.pd_ok | default(0) }}</span>/{{ server.pd_total | default(0) }}
          </span>
        </div>

        {% if server.health_status is defined and server.health_status %}
        <div class="mb-2">
          {% if server.health_status == 'OK' %}
          <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 small-badge">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-check-circle me-1" viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
              <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
            </svg>
            OK
          </span>
          {% else %}
          <span class="badge bg-danger bg-opacity-10 text-danger border border-danger border-opacity-25 small-badge" title="{{ server.health_status }}">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-exclamation-triangle me-1" viewBox="0 0 16 16">
              <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"/>
              <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"/>
            </svg>
            {{ server.health_status }}
          </span>
          {% endif %}
        </div>
        {% endif %}

        <div class="d-flex justify-content-between align-items-center mt-auto pt-2 border-top">
          <small class="text-muted">
            {{ _('Agent') }}: v{{ server.agent_version | default('N/A') }}
          </small>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right text-muted" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
          </svg>
        </div>
      </div>
    </div>
  </a>
</div>
